## ---- globalsetup, echo=FALSE, results='hide', cache=FALSE---------------
#opts_chunk$set(cache=TRUE, autodep=TRUE)

## ---- eval=FALSE---------------------------------------------------------
#  system.file(package="onemap")

## ---- eval=FALSE---------------------------------------------------------
#  example.out<- read.outcross("C:/workingdirectory","example.out.txt")

## ---- eval=FALSE, echo=FALSE---------------------------------------------
#  example.out<- read.outcross(system.file("example",package="onemap"),"example.out.txt")

## ---- eval=FALSE---------------------------------------------------------
#  example.out <- read.outcross(file="example.out.txt")

## ---- echo=FALSE, eval=FALSE---------------------------------------------
#  example.out <- read.outcross(system.file("example",package="onemap"),"example.out.txt")
#  save(example.out, file = "example.out.RData") #Must move it to proper directory

## ------------------------------------------------------------------------
data(example.out)

## ---- eval=FALSE---------------------------------------------------------
#  example.out

## ---- echo=FALSE---------------------------------------------------------
example.out

## ---- twopoint, results='hide'-------------------------------------------
twopts <- rf.2pts(example.out)

## ---- linkcriteria, results='hide'---------------------------------------
twopts <- rf.2pts(example.out, LOD=3, max.rf=0.4)

## ---- eval=FALSE---------------------------------------------------------
#  twopts

## ---- echo=FALSE---------------------------------------------------------
twopts

## ------------------------------------------------------------------------
print(twopts, "M1", "M3")

## ------------------------------------------------------------------------
mark.all <- make.seq(twopts, "all")

## ------------------------------------------------------------------------
marker.type(mark.all)

## ------------------------------------------------------------------------
LGs <- group(mark.all)

## ---- eval=FALSE---------------------------------------------------------
#  LGs

## ---- echo=FALSE---------------------------------------------------------
LGs

## ------------------------------------------------------------------------
print(LGs, detailed=FALSE)

## ------------------------------------------------------------------------
LGs <- group(mark.all, LOD=6)
LGs

## ------------------------------------------------------------------------
LGs <- group(mark.all, LOD=3, max.rf=0.4)
LGs

## ---- eval=FALSE---------------------------------------------------------
#  set.map.fun(type="haldane")

## ---- eval=FALSE---------------------------------------------------------
#  set.map.fun(type="kosambi")

## ------------------------------------------------------------------------
LG3 <- make.seq(LGs, 3)

## ---- eval=FALSE---------------------------------------------------------
#  LG3

## ---- echo=FALSE---------------------------------------------------------
LG3

## ----  results='hide'----------------------------------------------------
LG3.ser <- seriation(LG3)
LG3.rcd <- rcd(LG3)
LG3.rec <- record(LG3)
LG3.ug  <- ug(LG3)

## ----  results='hide'----------------------------------------------------
LG3.comp <- compare(LG3)

## ------------------------------------------------------------------------
LG3.comp

## ------------------------------------------------------------------------
LG3.final <- make.seq(LG3.comp,1,1)

## ------------------------------------------------------------------------
LG3.final <- make.seq(LG3.comp)

## ------------------------------------------------------------------------
LG3.final

## ------------------------------------------------------------------------
LG2 <- make.seq(LGs, 2)
LG2

## ------------------------------------------------------------------------
LG2.rcd <- rcd(LG2)
LG2.rcd

## ---- , echo=TRUE--------------------------------------------------------
marker.type(LG2)

## ---- results='hide'-----------------------------------------------------
LG2.init <- make.seq(twopts,c(4,23,19,20,24))
LG2.comp <- compare(LG2.init)

## ------------------------------------------------------------------------
LG2.comp

## ------------------------------------------------------------------------
LG2.frame <- make.seq(LG2.comp)

## ---- results='hide'-----------------------------------------------------
LG2.extend <- try_seq(LG2.frame,9)

## ------------------------------------------------------------------------
LG2.extend

## ------------------------------------------------------------------------
print(LG2.extend,5)

## ---- echo=TRUE----------------------------------------------------------
LG2.extend <- try_seq(LG2.frame, 9, draw.try=TRUE)

## ------------------------------------------------------------------------
LG2.frame <- make.seq(LG2.extend,5,1)

## ---- results='hide'-----------------------------------------------------
LG2.extend <- try_seq(LG2.frame,29)
LG2.frame <- make.seq(LG2.extend,7)
LG2.extend <- try_seq(LG2.frame,27)
LG2.frame <- make.seq(LG2.extend,1)
LG2.extend <- try_seq(LG2.frame, 16)
LG2.frame <- make.seq(LG2.extend,2)
LG2.extend <- try_seq(LG2.frame,21)
LG2.final <- make.seq(LG2.extend,6)

## ------------------------------------------------------------------------
LG2.ord <- order.seq(LG2, n.init=5, THRES=3, draw.try=FALSE)

## ------------------------------------------------------------------------
LG2.ord

## ------------------------------------------------------------------------
LG2.safe <- make.seq(LG2.ord,"safe")

## ------------------------------------------------------------------------
LG2.all <- make.seq(LG2.ord,"force")
LG2.all

## ---- results='hide'-----------------------------------------------------
LG2.ord <- order.seq(LG2, n.init=5, THRES=3, touchdown=TRUE)

## ------------------------------------------------------------------------
LG2.ord

## ------------------------------------------------------------------------
ripple_seq(LG2.all, ws=4, LOD=3)

## ------------------------------------------------------------------------
LG2.all

## ------------------------------------------------------------------------
LG1 <- make.seq(LGs, 1)

## ---- results='hide'-----------------------------------------------------
LG1.ord <- order.seq(LG1, n.init=6, touchdown=TRUE)

## ------------------------------------------------------------------------
LG1.ord

## ------------------------------------------------------------------------
(LG1.final <- make.seq(LG1.ord,"force"))

## ------------------------------------------------------------------------
ripple_seq(LG1.final)

## ------------------------------------------------------------------------
LG1.final

## ------------------------------------------------------------------------
LG1.ser <- seriation(LG1)
LG1.rcd <- rcd(LG1)
LG1.rec <- record(LG1)
LG1.ug  <- ug(LG1)

## ------------------------------------------------------------------------
any.seq <- make.seq(twopts,c(30,12,3,14,2))
(any.seq.map <- map(any.seq))

## ------------------------------------------------------------------------
any.seq <- make.seq(twopts,c(30,12,3,14,2),phase=c(4,1,4,3))
(any.seq.map <- map(any.seq))

## ------------------------------------------------------------------------
(any.seq <- add.marker(any.seq, 4:8))

## ------------------------------------------------------------------------
(any.seq <- drop.marker(any.seq, c(3,4,5,12,30)))

## ------------------------------------------------------------------------
(LGs <- group(mark.all, LOD=2.5))

## ---- results='hide'-----------------------------------------------------
LG.err <- make.seq(LGs, 2)
LG.err.ord <- order.seq(LG.err)

## ---- eval=FALSE---------------------------------------------------------
#  (LG.err.map <- make.seq(LG.err.ord, "force"))

## ---- echo=FALSE---------------------------------------------------------
LG.err.map <- map(make.seq(twopts,c(27,16,20,4,19,21,23,9,24,29,22,7,18, 8, 13), phase=c(1,1,2,4,1,3,1,2,3,3,2,1,4,4)))
LG.err.map

## ------------------------------------------------------------------------
rf.graph.table(LG.err.map)

## ----  echo=FALSE--------------------------------------------------------
rf.graph.table(LG.err.map, inter=FALSE)

## ---- echo=TRUE, fig=TRUE------------------------------------------------
maps <- list(LG1.final, LG2.final, LG3.final)
draw.map(maps, names= TRUE, grid=TRUE, cex.mrk=0.7)

## ---- width = 9.5, height = 9.5------------------------------------------
draw.map(LG1.final, names= TRUE, grid=TRUE, cex.mrk=0.7)

